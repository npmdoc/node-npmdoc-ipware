<div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a

        href="https://github.com/un33k/node-ipware"

    >ipware (v1.0.0)</a>
</h1>
<h4>Returns the real IP address of users in Node.js</h4>
<div class="apidocSectionDiv"><a
    href="#apidoc.tableOfContents"
    id="apidoc.tableOfContents"
><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.ipware">module ipware</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.ipware.ipware">
            function <span class="apidocSignatureSpan"></span>ipware
            <span class="apidocSignatureSpan">(config_file)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.ipware" id="apidoc.module.ipware">module ipware</a></h1>


    <h2>
        <a href="#apidoc.element.ipware.ipware" id="apidoc.element.ipware.ipware">
        function <span class="apidocSignatureSpan"></span>ipware
        <span class="apidocSignatureSpan">(config_file)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">ipware = function (config_file) {
    var _me = {};
    var _conf = config_file || __dirname + &#x27;/defaults.json&#x27;;

    function get_precedence_list() {
        try {
            ipware_precedence_list = ipware_defs.IPWARE_HTTP_HEADER_PRECEDENCE_ORDER;
        } catch(e) {
            throw e;
        }
    }

    function get_proxy_precedence_list() {
        try {
            ipware_proxy_precedence_list = ipware_defs.IPWARE_HTTP_HEADER_PROXY_PRECEDENCE_ORDER;
        } catch(e) {
            throw e;
        }
    }

    function get_proxy_list() {
        try {
            ipware_proxy_list = ipware_defs.IPWARE_TRUSTED_PROXY_LIST;
        } catch(e) {
            throw e;
        }
    }

    function get_non_routable_prefix_list() {
        for (var prefix in ipware_defs) {
            if (prefix.indexOf(&#x27;IPV4&#x27;) === 0 || prefix.indexOf(&#x27;IPV6&#x27;) === 0) {
                var private_prefix = ipware_defs[prefix];
                ipware_prefix_list = ipware_prefix_list.concat(private_prefix);
            }
        }
        if (ipware_prefix_list.length === 0) {
            throw &#x22;No private IP prefix found in &#x22; + _conf;
        }
    }

    function get_config_file() {
        try {
            ipware_defs = require(_conf);
        } catch(e) {
            throw e;
        }
    }

    function initialize() {
        if (!is_initialized) {
            get_config_file();
            get_precedence_list();
            get_proxy_precedence_list();
            get_proxy_list();
            get_non_routable_prefix_list();
            is_initialized = true;
        }
    }

    _me.is_loopback_ip = function (ip) {
        var ip = ip.toLowerCase().trim();
        return ip === &#x27;127.0.0.1&#x27; || ip === &#x27;::1&#x27;;
    }

    _me.is_private_ip = function (ip) {
        var ip = ip.toLowerCase();
        for (var i = 0; i &#x3c; ipware_prefix_list.length; i++) {
            var prefix = ipware_prefix_list[i];
            if (ip.indexOf(prefix.toLowerCase()) === 0) {
                return true;
            }
        }
        return false;
    }

    _me.is_valid_ipv4 = function (ip) {
        var ipv4_pattern = /^(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)\.(\d?\d?\d)$/;
        if (!ipv4_pattern.test(ip)) {
            return false;
        }
        var token = ip.split(&#x27;.&#x27;);
        return token[0] &#x3c;= 255 &#x26;&#x26; token[1] &#x3c;= 255 &#x26;&#x26; token[2] &#x3c;= 255 &#x26;&#x26; token[3] &#x3c;= 255;
    }

    _me.is_valid_ipv6 = function (ip) {
        var ipv6_pattern = /^::|^::1|^([a-fA-F0-9]{1,4}::?){1,7}([a-fA-F0-9]{1,4})$/;
        return ipv6_pattern.test(ip)
    }

    _me.is_valid_ip = function (ip) {
        return _me.is_valid_ipv4(ip) || _me.is_valid_ipv6(ip);
    }

    _me.get_headers_attribute = function (headers, key) {
        var key_upper = key.toUpperCase();
        if (key_upper in headers) {
            return headers[key_upper];
        }

        var key_lower = key.toLowerCase();
        if (key_lower in headers) {
            return headers[key_lower];
        }

        var alt_key_lower = key_lower.replace(/_/g, &#x27;-&#x27;);
        if (alt_key_lower in headers) {
            return headers[alt_key_lower];
        }

        var alt_key_upper = alt_key_lower.toUpperCase()
        if (alt_key_upper in headers) {
            return headers[alt_key_upper];
        }

        return null;
    }

    _me.get_local_ip = function (req) {
        var ip = &#x27;127.0.0.1&#x27;;
        try {
            ip = req.connection.remoteAddress;
        } catch (e) {
            try {
                ip = req.socket.remoteAddress;
            } catch (e) {
                try {
                    ip = req.connection.socket.remoteAddress;
                } catch (e) {
                    ip = &#x27;127.0.0.1&#x27;;
                }
            }
        }
        return ip || &#x27;127.0.0.1&#x27;;
    }

    _me.get_ip = function (req, right_most_proxy) {

        initialize();
        req.clientIpRoutable = false;
        req.clientIp = null;
        var value = null;
        var right_most_proxy = right_most_proxy || false;

        for (var i = 0; i &#x3c; ipware_precedence_list.length; i++) {
            value = _me.g ...</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
